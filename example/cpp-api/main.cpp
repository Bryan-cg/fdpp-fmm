#include "force_directed_pp.hpp"
#include <iostream>

using namespace FDPP;
using namespace FDPP::EF;

int main(int argc, char **argv)
{
  SPDLOG_INFO("Fast Map Matching with force directed preprocessing");
  if (argc != 4)
  {
    SPDLOG_ERROR("Incorrect number of arguments: {}", argc);
  }
  else
  {
    // std::string wkt("LINESTRING(8.866535425186155 53.07008919489871,8.867608308792114 53.06975398660555,8.86896014213562 53.069212490774134,8.869324922561644 53.06858073703236,8.870333433151243 53.06818105130765,8.870891332626343 53.06801344006115,8.871663808822632 53.067781361873756,8.872393369674683 53.067355881948856,8.871599435806274 53.0663888664875,8.870505094528196 53.065705495802376,8.870784044265745 53.06547340517875,8.870311975479122 53.06485449073509,8.868826031684875 53.06394544402286,8.867817521095276 53.062449665836056,8.866787552833555 53.06213374052385,8.8657146692276 53.062900983691435,8.863450884819029 53.062372296586034,8.861584067344664 53.06368755493753,8.859631419181822 53.06344900615903,8.85943830013275 53.063674660442786)");
    // std::string wkt("LINESTRING(8.865854144096375 53.07001828566965,8.866031169891356 53.070301921885346,8.86643350124359 53.07025357493521,8.866562247276304 53.07000216991949,8.867028951644897 53.07000539307003,8.867023587226868 53.06982811943354,8.867361545562742 53.069895805817225,8.867377638816832 53.06970241586728,8.867892622947691 53.06968629999895,8.867801427841187 53.06952514098364,8.868042826652525 53.069541256912316,8.868123292922974 53.06938009735427,8.86841297149658 53.069328526168306,8.86873483657837 53.06900942808204,8.869040608406067 53.06900942808204,8.869083523750305 53.0688837221262,8.869389295578003 53.068832150345884,8.869389295578003 53.06871611361433,8.869764804840088 53.06869999737691,8.869855999946594 53.06851304858182,8.870279788970947 53.068458253091535,8.870274424552917 53.06825196356172,8.870977163314818 53.06809724576593,8.871089816093443 53.06779425513918,8.871513605117796 53.067797478454935,8.87192666530609 53.067449358959294,8.87219488620758 53.06740745549692,8.872232437133787 53.067333318502136)");

    // shapefile, tracefile, ubodtfile
    std::unique_ptr<ForceDirectedPP> fdpp(new ForceDirectedPP(argv[1], argv[2], argv[3]));
    fdpp->match();
  }
  SPDLOG_INFO("Finished");
  return 0;
};
